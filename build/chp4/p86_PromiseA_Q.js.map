{"version":3,"sources":["../../chp4/p86_PromiseA_Q.js"],"names":[],"mappings":";;;;AAGA;;;;AACA;;;;;;;;;;;;;;;IAEM,O;;;AACF,uBAAc;AAAA;;AAAA;AAEb;;;;6BAEI,gB,EAAkB,Y,EAAc,e,EAAiB;AAClD,gBAAI,OAAO,gBAAP,KAA4B,UAAhC,EAA4C;AACxC,qBAAK,IAAL,CAAU,SAAV,EAAqB,gBAArB;AACH;AACD,gBAAI,OAAQ,YAAR,KAAyB,UAA7B,EAAyC;AACrC,qBAAK,IAAL,CAAU,OAAV,EAAmB,YAAnB;AACH;AACD,gBAAI,OAAO,eAAP,KAA2B,UAA/B,EAA2C;AACvC,qBAAK,EAAL,CAAQ,UAAR,EAAoB,eAApB;AACH;;AAED,mBAAO,IAAP;AACH;;;;EAjBiB,iBAAO,Y;;IAoBvB,C;AACF,iBAAc;AAAA;;AACV,aAAK,OAAL,GAAe,IAAI,OAAJ,EAAf;AACH;;;;2CAEkB;AACf,gBAAI,OAAO,IAAX;AACA,mBAAO,UAAS,KAAT,EAAgB,KAAhB,EAAuB;AAC1B,oBAAI,KAAJ,EAAW;AACP,yBAAK,MAAL,CAAY,KAAZ;AACH,iBAFD,MAEO,IAAI,UAAU,MAAV,GAAmB,CAAvB,EAA0B;AAC7B,yBAAK,OAAL,CAAa,GAAG,KAAH,CAAS,IAAT,CAAc,SAAd,EAAyB,CAAzB,CAAb;AACH,iBAFM,MAEA;AACH,yBAAK,OAAL,CAAa,KAAb;AACH;AACJ,aARD;AASH;;;+BAEM,K,EAAO;AACV,iBAAK,OAAL,CAAa,IAAb,CAAkB,OAAlB,EAA2B,KAA3B;AACH;;;gCAEO,K,EAAO;AACX,iBAAK,OAAL,CAAa,IAAb,CAAkB,SAAlB,EAA6B,KAA7B;AACH;;;;;;;;;AAIL,IAAI,WAAW,SAAX,QAAW,CAAS,IAAT,EAAe,QAAf,EAAyB;AACpC,QAAI,WAAW,IAAI,CAAJ,EAAf;AACA,iBAAG,QAAH,CAAY,IAAZ,EAAkB,QAAlB,EAA4B,SAAS,gBAAT,EAA5B;AACA,WAAO,SAAS,OAAhB;AACH,CAJD;;AAMA,SAAS,eAAT,EAA0B,MAA1B,EAAkC,IAAlC,CAAuC,UAAC,IAAD,EAAU;AAC7C,YAAQ,GAAR,CAAY,SAAZ;AACA,YAAQ,GAAR,CAAY,IAAZ;AACH,CAHD,EAGG,UAAC,GAAD,EAAS;AACR,YAAQ,GAAR,CAAY,QAAZ;AACH,CALD","file":"p86_PromiseA_Q.js","sourcesContent":["/**\n * Created by fulvaz on 16/6/25.\n */\nimport fs from 'fs'\nimport events from 'events'\n\nclass Promise extends events.EventEmitter {\n    constructor() {\n        super();\n    }\n\n    then(fulfilledHandler, errorHandler, progressHandler) {\n        if (typeof fulfilledHandler === 'function') {\n            this.once('success', fulfilledHandler);\n        }\n        if (typeof  errorHandler === 'function') {\n            this.once('error', errorHandler);\n        }\n        if (typeof progressHandler === 'function') {\n            this.on('progress', progressHandler);\n        }\n\n        return this;\n    }\n}\n\nclass Q {\n    constructor() {\n        this.promise = new Promise();\n    }\n\n    makeNodeResolver() {\n        let self = this;\n        return function(error, value) {\n            if (error) {\n                self.reject(error);\n            } else if (arguments.length > 2) {\n                self.resolve([].slice.call(arguments, 1));\n            } else {\n                self.resolve(value);\n            }\n        }\n    }\n    \n    reject(error) {\n        this.promise.emit('error', error);\n    }\n    \n    resolve(value) {\n        this.promise.emit('success', value);\n    }\n}\n\n// usage\nlet readFile = function(file, encoding) {\n    let deffered = new Q();\n    fs.readFile(file, encoding, deffered.makeNodeResolver());\n    return deffered.promise;\n}\n\nreadFile('./Deffered.js', 'utf8').then((data) => {\n    console.log('success');\n    console.log(data);\n}, (err) => {\n    console.log('failed');\n});"]}